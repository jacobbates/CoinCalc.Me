/*
  Â© CoinCalc.Me | v1.2 | https://github.com/jacobbates/CoinCalc.Me
*/
$(document).ready(function(){function a(a,b){$(a).tooltip("hide").attr("data-original-title",b).tooltip("show")}function f(a){setTimeout(function(){$(a).tooltip("hide")},1E3)}$.urlParam=function(a){a=(new RegExp("[?&]"+a+"=([^&#]*)")).exec(window.location.href);return null==a?null:a[1]||0};var b=$.urlParam("c"),c=$.urlParam("a"),e=$.urlParam("bp"),d=$.urlParam("bf"),g=$.urlParam("sp"),h=$.urlParam("sf");b&&$("#coin_name").val(decodeURIComponent(b));$.isNumeric(c)&&$("#buy_amount").val(c);$.isNumeric(e)&&
$("#buy_price").val(e);$.isNumeric(d)&&$("#buy_fees").val(d);$.isNumeric(g)&&$("#sell_price").val(g);$.isNumeric(h)&&$("#sell_fees").val(h);e=$.urlParam("af");b=decodeURIComponent($.urlParam("t"));c=decodeURIComponent($.urlParam("f"));1==e&&1<=b.length&&5>=b.length&&($("#fetch_auto").prop("checked",!0),$("#fetch_ticker").val(b),e="USD",c.length=3,e=c,$("#fetch_fiat").val(e),autoFetch(e,b),updateURL());updateCalc();$(".btn-copy").tooltip({trigger:"click",placement:"top"});b=new Clipboard(".btn-copy");
b.on("success",function(b){a(b.trigger,"Copied!");f(b.trigger)});b.on("error",function(b){a(b.trigger,"Failed!");f(b.trigger)});$("#fetch_auto").click(function(){updateURL()});$("#fetch_update").click(function(){if($("#fetch_auto").prop("checked")){var a=$("#fetch_ticker").val(),b=$("#fetch_fiat").val();autoFetch(b,a)}})});
function autoFetch(a,f){var b=0;$.get("https://api.coinmarketcap.com/v1/ticker/?convert="+a,function(c,e){for(var d=0;d<c.length-1;d++)c[d].symbol==f&&(fetch_name=c[d].name,b=c[d].price_usd,"AUD"==a?b=c[d].price_aud:"EUR"==a?b=c[d].price_eur:"CAD"==a&&(b=c[d].price_cad),$("#coin_name").val(fetch_name),$("#sell_price").val(parseFloat(b)),updateCalc())})}
$("#calc_method").on("change",function(){var a=$("#calc_method").val();"Amount+Price"==a?(a=1*$("#buy_amount").val(),$("#buy_amount").remove(),$(".buy-amount").append('<input id="buy_amount" class="form-control bg-yellow" type="number" value="'+parseFloat(a.toFixed(6))+'">'),a=1*$("#buy_total").val(),$("#buy_total").remove(),$(".buy-total").append('<input id="buy_total" class="form-control" type="input" value="$'+a.toFixed(2)+'" disabled>'),a=$("#buy_price").val().replace("$",""),a*=1,$("#buy_price").remove(),
$(".buy-price").append('<input id="buy_price" class="form-control bg-yellow" type="number" value="'+parseFloat(a.toFixed(6))+'">')):"Price+Total"==a?(a=1*$("#buy_amount").val(),$("#buy_amount").remove(),$(".buy-amount").append('<input id="buy_amount" class="form-control" type="number" value="'+parseFloat(a.toFixed(6))+'" disabled>'),a=$("#buy_total").val().replace("$",""),a*=1,$("#buy_total").remove(),$(".buy-total").append('<input id="buy_total" class="form-control bg-yellow" type="number" value="'+
a.toFixed(2)+'">'),a=$("#buy_price").val().replace("$",""),a*=1,$("#buy_price").remove(),$(".buy-price").append('<input id="buy_price" class="form-control bg-yellow" type="number" value="'+parseFloat(a.toFixed(6))+'">')):"Amount+Total"==a&&(a=1*$("#buy_amount").val(),$("#buy_amount").remove(),$(".buy-amount").append('<input id="buy_amount" class="form-control bg-yellow" type="number" value="'+parseFloat(a.toFixed(6))+'">'),a=$("#buy_total").val().replace("$",""),a*=1,$("#buy_total").remove(),$(".buy-total").append('<input id="buy_total" class="form-control bg-yellow" type="number" value="'+
a.toFixed(2)+'">'),a=1*$("#buy_price").val(),$("#buy_price").remove(),$(".buy-price").append('<input id="buy_price" class="form-control" type="input" value="$'+parseFloat(a.toFixed(6))+'" disabled>'))});
function updateCalc(){var a=$("#calc_method").val(),f=1*$("#buy_fees").val(),b=0;if("Amount+Price"==a){var c=1*$("#buy_amount").val();var e=1*$("#buy_price").val();var d=c*e;var g=f/100*d;b=d+g;$("#buy_total").val("$"+b.toFixed(2))}else"Price+Total"==a?(b=1*$("#buy_total").val(),d=b/(1+f/100),g=b-d,e=1*$("#buy_price").val(),c=d/e,$("#buy_amount").val(parseFloat(c.toFixed(6)))):"Amount+Total"==a&&(b=1*$("#buy_total").val(),d=b/(1+f/100),g=b-d,c=1*$("#buy_amount").val(),e=d/c,$("#buy_price").val("$"+
parseFloat(e.toFixed(6))));$("#buy_value").val("$"+d.toFixed(2));$("#buy_txcost").val("$"+g.toFixed(2));a=c;g=1*$("#sell_price").val();f=a*g;c=1*$("#sell_fees").val();c=c/100*f;d=f-c;e=(g-e)/e*100;b=d-b;$("#sell_amount").val(parseFloat(a.toFixed(6)));$("#sell_value").val("$"+f.toFixed(2));$("#sell_txcost").val("$"+c.toFixed(2));$("#sell_total").val("$"+d.toFixed(2));$("#value_change").val(e.toFixed(2)+"%");$("#profit_loss").val("$"+b.toFixed(2));updateURL()}
$(".estimator").on("keyup input change","input[type=number], #coin_name",function(){updateCalc()});$("#configModal").on("keyup input change","input, select",function(){updateURL()});
function updateURL(){var a=1*$("#buy_amount").val(),f=1*$("#buy_price").val(),b=1*$("#buy_fees").val(),c=1*$("#sell_price").val(),e=1*$("#sell_fees").val(),d=encodeURIComponent($("#coin_name").val());f=parseFloat(f.toFixed(6));c=parseFloat(c.toFixed(6));a="https://coincalc.me/?c="+d+"&a="+a+"&bp="+f+"&bf="+b+"&sp="+c+"&sf="+e;$("#fetch_auto").prop("checked")&&(f=encodeURIComponent($("#fetch_ticker").val()),b=encodeURIComponent($("#fetch_fiat").val()),a=a+"&af=1&t="+f+"&f="+b);$("#save_url").val(a)};
